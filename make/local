BOOST=~/local/boost_1_65_1

#CC=clang++
#CC=g++-mp-6
#CXX=g++-mp-6

CXX=clang++
CC=clang++

#CXX=mpic++
#CC=mpic++

## from mpic++ --showme
CXXFLAGS+=-I/opt/local/include/openmpi-mp
LDFLAGS+=-L/opt/local/lib -L/opt/local/lib/openmpi-mp -lmpi_cxx -lmpi

CXXFLAGS+=-DSTAN_HAS_MPI
LDFLAGS += -L$(HOME)/local/lib -lboost_serialization -lboost_mpi

## for cachegrind
##CXXFLAGS+=-g

#CXXFLAGS +=-std=c++14
O = 3

#CXXFLAGS+=-Wno-unused-variable -Wno-unused-function
##CFLAGS+=-Wno-ignored-attributes -Wno-deprecated-declarations

STANCFLAGS=--allow_undefined --name=mpi_model

USER_HEADER=examples/mpi/mpi_defs3.hpp
MATH=$(HOME)/work/math/

#USER_HEADER=examples/mpi/mpi_defs2.hpp
#MATH=$(HOME)/work/math-mpi.old/

# note: first build cmdstan with the following two lines commented out
# also: install the two binary boost libraries somewhere and possibly
# adapt the path to it
#CC=mpicxx

## install from boost 1.65.0 the serialization and mpi library as
## shared libraries installed into an appropiate localtion and adapt

#CC=mpic++

#CXXFLAGS+=-DSTAN_HAS_MPI -I~/local/boost_1_65_1


## from mpicxx --showme
#LDFLAGS += -L/opt/local/lib/openmpi-mp -lmpi_cxx -lmpi
#CXXFLAGS += -I/opt/local/include/openmpi-mp


##LDFLAGS += $(HOME)/local/lib/libboost_serialization.a $(HOME)/local/lib/libboost_mpi.a 
#LDFLAGS += -L$(HOME)/local/lib -lboost_serialization  $(HOME)/local/lib/libboost_mpi.a 
#LDFLAGS += $(HOME)/local/lib/libboost_serialization.a -L$(HOME)/local/lib -lboost_mpi

##CFLAGS +=-DBOOST_MPI_STATIC_LINK=1 -DBOOST_MPI_DECL=BOOST_SYMBOL_IMPORT

# mpic++ --showme
# g++ -I/usr/include/openmpi-x86_64 -pthread -Wl,-rpath -Wl,/usr/lib64/openmpi/lib -Wl,--enable-new-dtags -L/usr/lib64/openmpi/lib -lmpi_cxx -lmpi

#CFLAGS+=-I/usr/include/openmpi-x86_64
#LDFLAGS+=-pthread -Wl,-rpath -Wl,/usr/lib64/openmpi/lib -Wl,--enable-new-dtags -L/usr/lib64/openmpi/lib -lmpi_cxx -lmpi -L$(HOME)/local/lib -lboost_serialization -lboost_mpi
